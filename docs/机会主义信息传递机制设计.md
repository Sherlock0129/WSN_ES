# æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’æœºåˆ¶è®¾è®¡æ–‡æ¡£

**ç‰ˆæœ¬**: 1.0  
**æ—¥æœŸ**: 2024-10-29  
**ä½œè€…**: WSN_ESå¼€å‘å›¢é˜Ÿ

---

## ğŸ“‹ ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒæ€æƒ³](#æ ¸å¿ƒæ€æƒ³)
3. [æ¶æ„è®¾è®¡](#æ¶æ„è®¾è®¡)
4. [æ•°æ®ç»“æ„](#æ•°æ®ç»“æ„)
5. [ç®—æ³•æµç¨‹](#ç®—æ³•æµç¨‹)
6. [å®ç°ç»†èŠ‚](#å®ç°ç»†èŠ‚)
7. [é…ç½®å‚æ•°](#é…ç½®å‚æ•°)
8. [ä½¿ç”¨åœºæ™¯](#ä½¿ç”¨åœºæ™¯)
9. [ä¼˜åŠ¿ä¸æƒè¡¡](#ä¼˜åŠ¿ä¸æƒè¡¡)

---

## ç³»ç»Ÿæ¦‚è¿°

### **é—®é¢˜èƒŒæ™¯**

åœ¨ä¼ ç»Ÿçš„è·¯å¾„ä¿¡æ¯æ”¶é›†æœºåˆ¶ä¸­ï¼Œèƒ½é‡ä¼ è¾“è·¯å¾„å®Œæˆåï¼Œè·¯å¾„ç»ˆç‚¹èŠ‚ç‚¹ä¼šç«‹å³å°†èšåˆä¿¡æ¯ä¸ŠæŠ¥ç»™ç‰©ç†ä¸­å¿ƒèŠ‚ç‚¹ã€‚è¿™ç§æœºåˆ¶è™½ç„¶ç®€å•ç›´æ¥ï¼Œä½†å­˜åœ¨ä»¥ä¸‹é—®é¢˜ï¼š

1. **èƒ½è€—å¼€é”€å¤§**ï¼šæ¯æ¬¡è·¯å¾„ç»“æŸåéƒ½éœ€è¦ä¸“é—¨çš„ä¿¡æ¯ä¼ é€’ï¼Œæ¶ˆè€—é¢å¤–çš„é€šä¿¡èƒ½é‡
2. **èµ„æºæµªè´¹**ï¼šä¿¡æ¯ä¼ é€’ä¸èƒ½é‡ä¼ è¾“åˆ†ç¦»ï¼Œæ— æ³•å……åˆ†åˆ©ç”¨å·²æœ‰çš„èƒ½é‡ä¼ è¾“è·¯å¾„
3. **æ•ˆç‡ä½ä¸‹**ï¼šèŠ‚ç‚¹é¢‘ç¹ä¸ŠæŠ¥ï¼Œå¢åŠ äº†ç½‘ç»œé€šä¿¡è´Ÿæ‹…

### **è§£å†³æ–¹æ¡ˆ**

è®¾è®¡ä¸€ç§**æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’æœºåˆ¶**ï¼ˆOpportunistic Information Forwardingï¼‰ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

- **å»¶è¿Ÿä¸ŠæŠ¥**ï¼šè·¯å¾„ç»“æŸåï¼ŒèŠ‚ç‚¹æºå¸¦ä¿¡æ¯è¿›å…¥"ç­‰å¾…çŠ¶æ€"ï¼Œä¸ç«‹å³ä¸ŠæŠ¥
- **æ­ä¾¿è½¦**ï¼šç­‰å¾…æ–°çš„èƒ½é‡ä¼ è¾“è·¯å¾„ç»è¿‡ï¼Œå°†ä¿¡æ¯"æ­è½½"åœ¨æ–°è·¯å¾„ä¸Šä¸€èµ·ä¼ é€’
- **æ™ºèƒ½è·¯ç”±**ï¼šè·¯ç”±ç®—æ³•ä¼˜å…ˆé€‰æ‹©ä¿¡æ¯é‡å¤§çš„èŠ‚ç‚¹ï¼Œå¢åŠ "æ­ä¾¿è½¦"çš„æˆåŠŸç‡
- **è¶…æ—¶ä¿æŠ¤**ï¼šè®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é—´ï¼Œé¿å…ä¿¡æ¯è¿‡æ—¶æˆ–æ— é™ç­‰å¾…

---

## æ ¸å¿ƒæ€æƒ³

### **1. ä¿¡æ¯é‡è¿½è¸ª**

ç‰©ç†ä¸­å¿ƒèŠ‚ç‚¹ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹çš„ä¿¡æ¯é‡çŠ¶æ€ï¼š

```
è·¯å¾„ä¸­åªæœ‰ç»ˆç‚¹èŠ‚ç‚¹ç´¯ç§¯ä¿¡æ¯é‡

è·¯å¾„ aâ†’bâ†’cï¼ˆ3ä¸ªèŠ‚ç‚¹ï¼‰ï¼š
- èŠ‚ç‚¹aï¼šä¸ç´¯ç§¯ä¿¡æ¯é‡ï¼ˆèµ·ç‚¹ï¼Œåªè´Ÿè´£ä¼ è¾“ï¼‰
- èŠ‚ç‚¹bï¼šä¸ç´¯ç§¯ä¿¡æ¯é‡ï¼ˆä¸­ç»§ï¼Œåªè´Ÿè´£è½¬å‘ï¼‰
- èŠ‚ç‚¹cï¼šæºå¸¦ base_data_size Ã— 3ï¼ˆæ•´æ¡è·¯å¾„çš„ä¿¡æ¯ï¼ša + b + cï¼‰
```

**å…³é”®ç‰¹æ€§**ï¼š
- **åªè¿½è¸ªç»ˆç‚¹èŠ‚ç‚¹**ï¼šåªæœ‰è·¯å¾„ç»ˆç‚¹èŠ‚ç‚¹ç´¯ç§¯æ•´æ¡è·¯å¾„çš„ä¿¡æ¯é‡
- **ä¸­é—´èŠ‚ç‚¹ä¸ç´¯ç§¯**ï¼šä¸­é—´èŠ‚ç‚¹åªæ˜¯è½¬å‘ä¿¡æ¯ï¼Œä¸ä¿ç•™ä¿¡æ¯é‡
- **ä¸­å¿ƒèŠ‚ç‚¹å…¨ç¨‹è¿½è¸ª**ï¼šå› ä¸ºè·¯å¾„è§„åˆ’æ˜¯ä¸­å¿ƒèŠ‚ç‚¹åšçš„ï¼Œæ‰€ä»¥çŸ¥é“è·¯å¾„ç»ˆç‚¹èŠ‚ç‚¹çš„ä¿¡æ¯é‡
- **ä¿¡æ¯é‡åŠ¨æ€æ›´æ–°**ï¼šæ¯æ¬¡è·¯å¾„å®Œæˆåï¼Œæ›´æ–°ç»ˆç‚¹èŠ‚ç‚¹çš„ç´¯ç§¯ä¿¡æ¯é‡

### **2. å½“å‰æœºåˆ¶ vs æ–°æœºåˆ¶**

#### **å½“å‰æœºåˆ¶ï¼ˆç«‹å³ä¸ŠæŠ¥ï¼‰**ï¼š

```
æ—¶é—´t1: è·¯å¾„ aâ†’bâ†’c å®Œæˆèƒ½é‡ä¼ è¾“
        â†“
æ—¶é—´t2: èŠ‚ç‚¹cç«‹å³ä¸ŠæŠ¥ä¿¡æ¯ç»™ä¸­å¿ƒèŠ‚ç‚¹
        - æ¶ˆè€—ä¸“é—¨çš„é€šä¿¡èƒ½é‡
        - ä¸­å¿ƒèŠ‚ç‚¹æ›´æ–°ä¿¡æ¯è¡¨
        - èŠ‚ç‚¹cçš„ä¿¡æ¯é‡æ¸…é›¶
```

**èƒ½è€—å¼€é”€**ï¼š
- èƒ½é‡ä¼ è¾“èƒ½è€—ï¼š`E_energy_transfer`
- ä¿¡æ¯ä¼ é€’èƒ½è€—ï¼š`E_info_transfer`ï¼ˆé¢å¤–å¼€é”€ï¼‰

#### **æ–°æœºåˆ¶ï¼ˆå»¶è¿Ÿä¸ŠæŠ¥ + æ­ä¾¿è½¦ï¼‰**ï¼š

```
æ—¶é—´t1: è·¯å¾„ aâ†’bâ†’c å®Œæˆèƒ½é‡ä¼ è¾“
        â†“
        èŠ‚ç‚¹cï¼ˆç»ˆç‚¹ï¼‰æºå¸¦ä¿¡æ¯ï¼ˆbase_data_size Ã— 3ï¼‰è¿›å…¥"ç­‰å¾…çŠ¶æ€"
        èŠ‚ç‚¹aã€èŠ‚ç‚¹bï¼ˆä¸­é—´èŠ‚ç‚¹ï¼‰ä¸ç´¯ç§¯ä¿¡æ¯é‡
        ä¸­å¿ƒèŠ‚ç‚¹è®°å½•ï¼šèŠ‚ç‚¹cä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆæœªä¸ŠæŠ¥ï¼‰
        â†“
æ—¶é—´t2: æ–°çš„èƒ½é‡ä¼ è¾“è·¯å¾„ dâ†’câ†’e è§„åˆ’
        - è·¯ç”±ç®—æ³•å‘ç°èŠ‚ç‚¹cä¿¡æ¯é‡å¤§ï¼Œä¼˜å…ˆé€‰æ‹©èŠ‚ç‚¹c
        - è·¯å¾„ dâ†’câ†’e ä¼ é€’èƒ½é‡çš„åŒæ—¶ï¼ŒèŠ‚ç‚¹cçš„ä¿¡æ¯ä¹Ÿä¸€èµ·ä¸ŠæŠ¥
        â†“
        ä¿¡æ¯"æ­ä¾¿è½¦"æˆåŠŸï¼ŒèŠ‚çœä¸€æ¬¡ä¸“é—¨çš„ä¿¡æ¯ä¼ é€’
```

**èƒ½è€—å¼€é”€**ï¼š
- èƒ½é‡ä¼ è¾“èƒ½è€—ï¼š`E_energy_transfer`
- ä¿¡æ¯ä¼ é€’èƒ½è€—ï¼š`0`ï¼ˆæ­è½½åœ¨èƒ½é‡ä¼ è¾“è·¯å¾„ä¸Šï¼Œé›¶é¢å¤–å¼€é”€ï¼‰

### **3. è·¯ç”±ç­–ç•¥è°ƒæ•´**

ä¸ºäº†å®ç°"æ­ä¾¿è½¦"ï¼Œéœ€è¦è°ƒæ•´è·¯ç”±é€‰æ‹©ç­–ç•¥ï¼š

**åŸå§‹ç­–ç•¥**ï¼š
```
èŠ‚ç‚¹é€‰æ‹©è¯„åˆ† = æ•ˆç‡ Ã— (1 / ä»£ä»·)
```

**ä¿¡æ¯æ„ŸçŸ¥ç­–ç•¥**ï¼š
```
èŠ‚ç‚¹é€‰æ‹©è¯„åˆ† = æ•ˆç‡ Ã— (1 / ä»£ä»·) Ã— (1 + ä¿¡æ¯å¥–åŠ±ç³»æ•° Ã— ä¿¡æ¯é‡æ¯”ä¾‹)

å…¶ä¸­ï¼š
- ä¿¡æ¯é‡æ¯”ä¾‹ = èŠ‚ç‚¹ç´¯ç§¯ä¿¡æ¯é‡ / base_data_size
- ä¿¡æ¯å¥–åŠ±ç³»æ•° = å¯é…ç½®å‚æ•°ï¼ˆé»˜è®¤0.1-0.3ï¼‰
```

**æ•ˆæœ**ï¼š
- ä¿¡æ¯é‡å¤§çš„èŠ‚ç‚¹æ›´å®¹æ˜“è¢«é€‰å…¥è·¯å¾„
- å¢åŠ "æ­ä¾¿è½¦"çš„æˆåŠŸç‡
- æé«˜ä¿¡æ¯ä¼ é€’çš„æœºä¼šä¸»ä¹‰æ•ˆç‡

---

## æ¶æ„è®¾è®¡

### **1. ç³»ç»Ÿæ¶æ„**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç‰©ç†ä¸­å¿ƒèŠ‚ç‚¹                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  è·¯å¾„è§„åˆ’æ¨¡å—    â”‚  â”‚  ä¿¡æ¯é‡è¿½è¸ªæ¨¡å—   â”‚                 â”‚
â”‚  â”‚  (EETORè·¯ç”±)    â”‚â†’ â”‚  (InfoVolumeTracker)â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚  â”‚  èŠ‚ç‚¹ä¿¡æ¯è¡¨      â”‚  â”‚  è·¯ç”±å†³ç­–æ¨¡å—     â”‚                 â”‚
â”‚  â”‚  (NodeInfoTable) â”‚  â”‚  (RouterDecision) â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  ä¼ æ„Ÿå™¨èŠ‚ç‚¹ç½‘ç»œ   â”‚
                    â”‚                  â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”   â”‚
                    â”‚  â”‚èŠ‚ç‚¹Aâ”‚ â”‚èŠ‚ç‚¹Bâ”‚   â”‚
                    â”‚  â””â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”˜   â”‚
                    â”‚       â†“    â†“     â”‚
                    â”‚      â”Œâ”€â”€â”€â”€â”     â”‚
                    â”‚      â”‚èŠ‚ç‚¹Câ”‚     â”‚
                    â”‚      â””â”€â”€â”€â”€â”˜     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **2. æ¨¡å—åˆ’åˆ†**

#### **2.1 ä¿¡æ¯é‡è¿½è¸ªæ¨¡å—ï¼ˆInfoVolumeTrackerï¼‰**

**èŒè´£**ï¼š
- åœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­ç»´æŠ¤æ¯ä¸ªèŠ‚ç‚¹çš„ç´¯ç§¯ä¿¡æ¯é‡
- æ›´æ–°è·¯å¾„å®Œæˆåçš„ä¿¡æ¯é‡ï¼ˆåªæ›´æ–°ç»ˆç‚¹èŠ‚ç‚¹ï¼‰
- è¿½è¸ªä¿¡æ¯çš„ç­‰å¾…æ—¶é—´å’Œè¶…æ—¶çŠ¶æ€
- è®°å½•ä¿¡æ¯çš„æ¥æºèŠ‚ç‚¹ï¼ˆå¯é€‰ï¼Œç”¨äºå»é‡ä¼˜åŒ–ï¼‰

**ä½ç½®**ï¼š`src/acdr/physical_center.py` - `NodeInfoManager`ç±»
**å®ç°æ–¹å¼**ï¼šç›´æ¥åœ¨`latest_info`ä¸­ç®¡ç†ä¿¡æ¯é‡å­—æ®µï¼Œä¸éœ€è¦å•ç‹¬çš„æ•°æ®ç»“æ„

#### **2.2 è·¯ç”±å†³ç­–æ¨¡å—ï¼ˆRouterDecisionï¼‰**

**èŒè´£**ï¼š
- åœ¨è·¯ç”±é€‰æ‹©æ—¶è€ƒè™‘èŠ‚ç‚¹ä¿¡æ¯é‡
- è°ƒæ•´èŠ‚ç‚¹é€‰æ‹©è¯„åˆ†ï¼Œä¼˜å…ˆé€‰æ‹©ä¿¡æ¯é‡å¤§çš„èŠ‚ç‚¹
- å®ç°ä¿¡æ¯æ„ŸçŸ¥çš„è·¯ç”±ç®—æ³•

**ä½ç½®**ï¼š`src/routing/energy_transfer_routing.py` - `select_forwarder_prefix_energy_aware`å‡½æ•°

**å®ç°æ–¹å¼**ï¼š
- éœ€è¦é€šè¿‡å‡½æ•°å‚æ•°ä¼ é€’`NodeInfoManager`å®ä¾‹æˆ–`latest_info`å­—å…¸
- åœ¨`compute_energy_transfer_costs`å’Œ`select_forwarder_prefix_energy_aware`ä¸­æ·»åŠ `node_info_manager`å‚æ•°
- é€šè¿‡`node_info_manager.get_node_info(node_id)`è·å–èŠ‚ç‚¹ä¿¡æ¯é‡

#### **2.3 è·¯å¾„è§„åˆ’æ¨¡å—ï¼ˆPathPlannerï¼‰**

**èŒè´£**ï¼š
- è§„åˆ’èƒ½é‡ä¼ è¾“è·¯å¾„
- æ£€æŸ¥è·¯å¾„æ˜¯å¦ç»è¿‡æœ‰ä¿¡æ¯é‡çš„èŠ‚ç‚¹
- è§¦å‘ä¿¡æ¯"æ­ä¾¿è½¦"æœºåˆ¶

**ä½ç½®**ï¼š`src/routing/energy_transfer_routing.py` - `find_energy_transfer_path`å‡½æ•°

#### **2.4 ä¿¡æ¯ä¸ŠæŠ¥æ¨¡å—ï¼ˆInfoReporterï¼‰**

**èŒè´£**ï¼š
- å†³å®šæ˜¯å¦åœ¨è·¯å¾„ä¸­ä¸ŠæŠ¥ä¿¡æ¯
- å¤„ç†"æ­ä¾¿è½¦"ä¿¡æ¯ä¼ é€’
- å¤„ç†è¶…æ—¶å¼ºåˆ¶ä¸ŠæŠ¥

**ä½ç½®**ï¼š`src/info_collection/path_based_collector.py` - `collect_and_report`å‡½æ•°

---

## æ•°æ®ç»“æ„

### **1. èŠ‚ç‚¹ä¿¡æ¯è¡¨æ‰©å±•ï¼ˆç»Ÿä¸€ç®¡ç†ï¼‰**

ä¿¡æ¯é‡çŠ¶æ€ç›´æ¥é›†æˆåˆ°èŠ‚ç‚¹ä¿¡æ¯è¡¨ `latest_info` ä¸­ï¼Œ**ä¸éœ€è¦å•ç‹¬ç»´æŠ¤**ï¼š

```python
# åœ¨ NodeInfoManager.latest_info ä¸­ç›´æ¥æ·»åŠ ä¿¡æ¯é‡å­—æ®µ
self.latest_info: Dict[int, Dict] = {
    node_id: {
        'energy': float,                 # èŠ‚ç‚¹èƒ½é‡ï¼ˆå¯èƒ½æ˜¯ä¼°ç®—å€¼ï¼‰
        'record_time': int,              # ä¿¡æ¯è®°å½•æ—¶é—´ï¼ˆé‡‡é›†æ—¶åˆ»ï¼‰
        'arrival_time': int,             # åˆ°è¾¾ç‰©ç†ä¸­å¿ƒçš„æ—¶é—´
        'position': (x, y),              # èŠ‚ç‚¹ä½ç½®
        'is_solar': bool,                # æ˜¯å¦æœ‰å¤ªé˜³èƒ½
        'cluster_id': int,               # æ‰€å±ç°‡ID
        'data_size': int,                # æ•°æ®åŒ…å¤§å°
        'aoi': int,                     # Age of Informationï¼ˆä¿¡æ¯å¹´é¾„ï¼Œæ¯åˆ†é’Ÿ+1ï¼‰
        'is_estimated': bool,            # æ˜¯å¦ä¸ºä¼°ç®—å€¼
        't': int,                        # å…¨å±€æ—¶é—´æˆ³ï¼ˆç»Ÿä¸€æ—¶é’Ÿï¼Œä»0å¼€å§‹æ¯åˆ†é’Ÿ+1ï¼‰
        
        # æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’å­—æ®µï¼ˆæ–°å¢ï¼‰
        'info_volume': int,              # ç´¯ç§¯çš„ä¿¡æ¯é‡ï¼ˆbitsï¼‰ï¼Œ0è¡¨ç¤ºæ— ä¿¡æ¯é‡
        'info_waiting_since': int,       # å¼€å§‹ç­‰å¾…çš„æ—¶é—´æˆ³ï¼ˆåˆ†é’Ÿï¼‰ï¼Œ-1è¡¨ç¤ºæœªç­‰å¾…
        'info_source_nodes': List[int],  # ä¿¡æ¯æ¥æºèŠ‚ç‚¹åˆ—è¡¨ï¼ˆå¯é€‰ï¼Œç”¨äºå»é‡ä¼˜åŒ–ï¼‰
        'info_is_reported': bool         # æ˜¯å¦å·²ä¸ŠæŠ¥ï¼ˆTrueè¡¨ç¤ºå·²ä¸ŠæŠ¥æˆ–ç«‹å³ä¸ŠæŠ¥æ¨¡å¼ï¼‰
    }
}
```

**è®¾è®¡ä¼˜åŠ¿**ï¼š
- **ç»Ÿä¸€ç®¡ç†**ï¼šä¿¡æ¯é‡ä¸èŠ‚ç‚¹å…¶ä»–ä¿¡æ¯ä¸€èµ·ç»´æŠ¤ï¼Œé¿å…æ•°æ®å†—ä½™
- **ç®€åŒ–æŸ¥è¯¢**ï¼šæŸ¥è¯¢èŠ‚ç‚¹ä¿¡æ¯æ—¶åŒæ—¶è·å–ä¿¡æ¯é‡çŠ¶æ€ï¼Œæ— éœ€é¢å¤–æŸ¥æ‰¾
- **ä¸€è‡´æ€§**ï¼šä¿¡æ¯é‡ä¸å…¶ä»–èŠ‚ç‚¹ä¿¡æ¯ä¿æŒåŒæ­¥æ›´æ–°
- **ç®€æ´æ€§**ï¼šä¸éœ€è¦ç»´æŠ¤å•ç‹¬çš„`info_volume_state`å­—å…¸

**é‡è¦æ³¨æ„äº‹é¡¹**ï¼š
- **å­—æ®µåˆå§‹åŒ–**ï¼šåœ¨`NodeInfoManager.initialize_node_info`ä¸­ï¼Œä¿¡æ¯é‡å­—æ®µéœ€è¦åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ï¼ˆ`info_volume=0`, `info_waiting_since=-1`, `info_is_reported=True`, `info_source_nodes=[]`ï¼‰
- **å­—æ®µä¿æŠ¤**ï¼šç”±äº`update_node_info`æ–¹æ³•ä¼šè¦†ç›–æ•´ä¸ªå­—å…¸ï¼Œåœ¨è°ƒç”¨`update_node_info`åï¼Œéœ€è¦é‡æ–°è®¾ç½®ä¿¡æ¯é‡å­—æ®µï¼ˆå¦‚æœè¯¥èŠ‚ç‚¹æœ‰ç­‰å¾…ä¸­çš„ä¿¡æ¯é‡ï¼‰
- **å‘åå…¼å®¹**ï¼šåœ¨è¯»å–ä¿¡æ¯é‡å­—æ®µæ—¶ï¼Œéœ€è¦ä½¿ç”¨`.get()`æ–¹æ³•ï¼Œä»¥å…¼å®¹æ—§æ•°æ®ï¼ˆæ²¡æœ‰ä¿¡æ¯é‡å­—æ®µï¼‰

### **3. è·¯ç”±é…ç½®å‚æ•°**

åœ¨ `EETORConfig` ä¸­æ·»åŠ ï¼š

```python
@dataclass
class EETORConfig:
    # ... ç°æœ‰å‚æ•° ...
    
    # ä¿¡æ¯æ„ŸçŸ¥è·¯ç”±å‚æ•°
    enable_info_aware_routing: bool = False  # æ˜¯å¦å¯ç”¨ä¿¡æ¯æ„ŸçŸ¥è·¯ç”±
    info_reward_factor: float = 0.2          # ä¿¡æ¯å¥–åŠ±ç³»æ•°ï¼ˆ0~1ï¼‰
    max_info_wait_time: int = 10              # æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    min_info_volume_threshold: int = 1       # æœ€å°ä¿¡æ¯é‡é˜ˆå€¼ï¼ˆèŠ‚ç‚¹æ•°ï¼‰
```

### **4. è·¯å¾„æ”¶é›†å™¨é…ç½®**

åœ¨ `PathCollectorConfig` ä¸­æ·»åŠ ï¼š

```python
@dataclass
class PathCollectorConfig:
    # ... ç°æœ‰å‚æ•° ...
    
    # æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’å‚æ•°
    enable_opportunistic_info_forwarding: bool = True  # æ˜¯å¦å¯ç”¨æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’
    enable_delayed_reporting: bool = True               # æ˜¯å¦å¯ç”¨å»¶è¿Ÿä¸ŠæŠ¥
    max_wait_time: int = 10                              # æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
```

---

## ç®—æ³•æµç¨‹

### **1. è·¯å¾„å®Œæˆåçš„ä¿¡æ¯é‡æ›´æ–°æµç¨‹**

**å®ç°ä½ç½®**ï¼š`src/info_collection/path_based_collector.py` - `collect_and_report`æ–¹æ³•

**è°ƒç”¨æ—¶æœº**ï¼šæ¯æ¬¡èƒ½é‡ä¼ è¾“è·¯å¾„å®Œæˆåï¼Œç”±`EnergySimulation`è°ƒç”¨`PathBasedInfoCollector.collect_and_report`

```
è¾“å…¥ï¼šè·¯å¾„ path = [node_a, node_b, node_c]ï¼Œå½“å‰æ—¶é—´ current_time
è¾“å‡ºï¼šæ›´æ–°ä¿¡æ¯é‡çŠ¶æ€è¡¨ï¼ˆåªæ›´æ–°ç»ˆç‚¹èŠ‚ç‚¹ï¼‰

ç®—æ³•ï¼š
1. è·å–è·¯å¾„ç»ˆç‚¹èŠ‚ç‚¹
   receiver = path[-1]  # ç»ˆç‚¹èŠ‚ç‚¹
   
2. è®¡ç®—æ•´æ¡è·¯å¾„çš„ä¿¡æ¯é‡
   if enable_accumulative_data_size:
       # ç´¯ç§¯æ¨¡å¼ï¼šä¿¡æ¯é‡ = base_data_size Ã— è·¯å¾„èŠ‚ç‚¹æ•°
       path_info_volume = base_data_size Ã— len(path)
   else:
       # å›ºå®šæ¨¡å¼ï¼šä¿¡æ¯é‡ = base_data_sizeï¼ˆå›ºå®šå¤§å°ï¼‰
       path_info_volume = base_data_size
   
3. æ›´æ–°ç»ˆç‚¹èŠ‚ç‚¹çš„ä¿¡æ¯é‡ï¼ˆåœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­ï¼Œé€šè¿‡self.vcè®¿é—®ï¼‰
   if path_info_volume > 0:
       # ç¡®ä¿ç»ˆç‚¹èŠ‚ç‚¹åœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­ï¼ˆé€šè¿‡self.vcè®¿é—®NodeInfoManagerï¼‰
       if receiver.node_id not in self.vc.latest_info:
           # èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œå…ˆåˆå§‹åŒ–åŸºæœ¬ä¿¡æ¯
           self.vc.update_node_info(
               node_id=receiver.node_id,
               energy=receiver.current_energy,
               record_time=current_time,
               arrival_time=current_time,
               position=tuple(receiver.position),
               is_solar=receiver.has_solar
           )
       
       # **é‡è¦**ï¼šupdate_node_infoä¼šè¦†ç›–æ•´ä¸ªå­—å…¸ï¼Œæ‰€ä»¥éœ€è¦å…ˆä¿å­˜ä¿¡æ¯é‡å­—æ®µï¼ˆå¦‚æœå­˜åœ¨ï¼‰
       existing_info_volume = self.vc.latest_info[receiver.node_id].get('info_volume', 0)
       existing_waiting_since = self.vc.latest_info[receiver.node_id].get('info_waiting_since', -1)
       existing_is_reported = self.vc.latest_info[receiver.node_id].get('info_is_reported', True)
       existing_source_nodes = self.vc.latest_info[receiver.node_id].get('info_source_nodes', [])
       
       # ç¡®ä¿ä¿¡æ¯é‡å­—æ®µå­˜åœ¨ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™åˆå§‹åŒ–ï¼‰
       if 'info_volume' not in self.vc.latest_info[receiver.node_id]:
           self.vc.latest_info[receiver.node_id]['info_volume'] = existing_info_volume
           self.vc.latest_info[receiver.node_id]['info_waiting_since'] = existing_waiting_since
           self.vc.latest_info[receiver.node_id]['info_is_reported'] = existing_is_reported
           self.vc.latest_info[receiver.node_id]['info_source_nodes'] = existing_source_nodes
       
       # æ›´æ–°ä¿¡æ¯é‡å­—æ®µï¼ˆç›´æ¥åœ¨latest_infoä¸­æ“ä½œï¼‰
       if enable_delayed_reporting:
           # å»¶è¿Ÿä¸ŠæŠ¥æ¨¡å¼ï¼šç´¯ç§¯ä¿¡æ¯é‡ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€
           self.vc.latest_info[receiver.node_id]['info_volume'] += path_info_volume
           self.vc.latest_info[receiver.node_id]['info_waiting_since'] = current_time
           self.vc.latest_info[receiver.node_id]['info_is_reported'] = False
           # å¯é€‰ï¼šè®°å½•ä¿¡æ¯æ¥æºèŠ‚ç‚¹ï¼ˆç”¨äºå»é‡ä¼˜åŒ–ï¼‰
           if 'info_source_nodes' not in self.vc.latest_info[receiver.node_id]:
               self.vc.latest_info[receiver.node_id]['info_source_nodes'] = []
           self.vc.latest_info[receiver.node_id]['info_source_nodes'].extend([n.node_id for n in path])
       else:
           # ç«‹å³ä¸ŠæŠ¥æ¨¡å¼ï¼šä¿¡æ¯é‡æ¸…é›¶ï¼Œæ ‡è®°å·²ä¸ŠæŠ¥
           self.vc.latest_info[receiver.node_id]['info_volume'] = 0
           self.vc.latest_info[receiver.node_id]['info_waiting_since'] = -1
           self.vc.latest_info[receiver.node_id]['info_is_reported'] = True
           # ä¸ŠæŠ¥ä¿¡æ¯ç»™ä¸­å¿ƒèŠ‚ç‚¹
           report_info(receiver, path_info_volume)
   
   # ä¸­é—´èŠ‚ç‚¹æ¸…é›¶ä¿¡æ¯é‡ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰
   for i in range(len(path) - 1):
       intermediate_node = path[i]
       if intermediate_node.node_id in self.vc.latest_info:
           # ç¡®ä¿ä¿¡æ¯é‡å­—æ®µå­˜åœ¨
           if 'info_volume' not in self.vc.latest_info[intermediate_node.node_id]:
               self.vc.latest_info[intermediate_node.node_id]['info_volume'] = 0
               self.vc.latest_info[intermediate_node.node_id]['info_waiting_since'] = -1
               self.vc.latest_info[intermediate_node.node_id]['info_is_reported'] = True
           # ä¸­é—´èŠ‚ç‚¹ä¸ä¿ç•™ä¿¡æ¯é‡ï¼Œæ¸…é›¶
           self.vc.latest_info[intermediate_node.node_id]['info_volume'] = 0
           self.vc.latest_info[intermediate_node.node_id]['info_waiting_since'] = -1
           self.vc.latest_info[intermediate_node.node_id]['info_is_reported'] = True
```

### **2. ä¿¡æ¯æ„ŸçŸ¥è·¯ç”±é€‰æ‹©æµç¨‹**

```
è¾“å…¥ï¼šå½“å‰èŠ‚ç‚¹ u_idï¼Œé‚»å±…èŠ‚ç‚¹åˆ—è¡¨ neighbors_idsï¼Œä»£ä»·å­—å…¸ Cï¼Œnode_info_managerï¼ˆå¯é€‰ï¼‰
è¾“å‡ºï¼šæœ€ä¼˜è½¬å‘å‰ç¼€ï¼Œè·¯å¾„æ•ˆç‡

ç®—æ³•ï¼š
1. ä¸ºæ¯ä¸ªé‚»å±…è®¡ç®—ç»¼åˆè¯„åˆ†
   for v_id in neighbors_ids:
       # è·å–é“¾è·¯æ•ˆç‡å’Œä»£ä»·
       eta = get_link_efficiency(u_id, v_id)
       C_v = C[v_id]
       
       # åŸºç¡€è¯„åˆ†ï¼šæ•ˆç‡ Ã— (1 / ä»£ä»·)
       base_score = eta Ã— (1 / max(C_v, 1.0))
       
       # å¦‚æœå¯ç”¨ä¿¡æ¯æ„ŸçŸ¥è·¯ç”±
       if enable_info_aware_routing and node_info_manager is not None:
           # ä»èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­è·å–èŠ‚ç‚¹vçš„ç´¯ç§¯ä¿¡æ¯é‡
           v_node_info = node_info_manager.get_node_info(v_id)
           v_info_volume = v_node_info.get('info_volume', 0) if v_node_info else 0
           
           # è®¡ç®—ä¿¡æ¯é‡æ¯”ä¾‹ï¼ˆå½’ä¸€åŒ–åˆ°base_data_sizeï¼‰
           # æ³¨æ„ï¼šbase_data_sizeéœ€è¦é€šè¿‡é…ç½®è·å–æˆ–ä½œä¸ºå‚æ•°ä¼ é€’
           info_ratio = v_info_volume / base_data_size if base_data_size > 0 else 0
           
           # è®¡ç®—ä¿¡æ¯å¥–åŠ±ï¼ˆä¿¡æ¯é‡è¶Šå¤§ï¼Œå¥–åŠ±è¶Šå¤§ï¼‰
           info_bonus = 1.0 + info_reward_factor Ã— info_ratio
           
           # ç»¼åˆè¯„åˆ†ï¼šåŸºç¡€è¯„åˆ† Ã— ä¿¡æ¯å¥–åŠ±
           score = base_score Ã— info_bonus
       else:
           score = base_score
       
       candidates.append((score, v_id, eta, C_v))

2. æŒ‰è¯„åˆ†é™åºæ’åº
   candidates.sort(key=lambda x: x[0], reverse=True)

3. è´ªå¿ƒé€‰æ‹©æœ€ä¼˜å‰ç¼€
   for score, v_id, eta, C_v in candidates:
       trial_fwd.append(v_id)
       
       # è®¡ç®—æ–°çš„æœŸæœ›ä»£ä»·
       cost, path_eff = expected_cost_for_energy_transfer(...)
       
       if cost < best_cost:
           best_cost = cost
           best_fwd = list(trial_fwd)
       else:
           break

4. è¿”å›æœ€ä¼˜ç»“æœ
   return best_cost, best_fwd, best_path_efficiency
```

### **3. è·¯å¾„ä¸­çš„ä¿¡æ¯"æ­ä¾¿è½¦"æµç¨‹**

```
è¾“å…¥ï¼šè·¯å¾„ path = [node_a, node_b, node_c]ï¼Œå½“å‰æ—¶é—´ current_time
è¾“å‡ºï¼šæ˜¯å¦æˆåŠŸ"æ­ä¾¿è½¦"

ç®—æ³•ï¼š
1. æ£€æŸ¥è·¯å¾„ä¸­çš„èŠ‚ç‚¹æ˜¯å¦æœ‰æºå¸¦æœªä¸ŠæŠ¥ä¿¡æ¯
   # æ³¨æ„ï¼šç”±äºåªæœ‰ç»ˆç‚¹èŠ‚ç‚¹ç´¯ç§¯ä¿¡æ¯ï¼Œæ‰€ä»¥åªéœ€æ£€æŸ¥è·¯å¾„ä¸­èŠ‚ç‚¹ä¹‹å‰æ˜¯å¦ä½œä¸ºç»ˆç‚¹ç´¯ç§¯è¿‡ä¿¡æ¯
   # ä»èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æŸ¥è¯¢ä¿¡æ¯é‡çŠ¶æ€ï¼ˆé€šè¿‡PathBasedInfoCollectorçš„self.vcè®¿é—®ï¼‰
   nodes_with_info = []
   for node in path:
       # é€šè¿‡self.vcï¼ˆNodeInfoManagerï¼‰è·å–èŠ‚ç‚¹ä¿¡æ¯
       node_info = self.vc.get_node_info(node.node_id)
       if node_info:
           info_volume = node_info.get('info_volume', 0)
           is_reported = node_info.get('info_is_reported', True)
           
           # æ£€æŸ¥æ˜¯å¦æœ‰æœªä¸ŠæŠ¥çš„ä¿¡æ¯é‡
           if not is_reported and info_volume > 0:
               nodes_with_info.append((node, node_info))

2. å¦‚æœæœ‰èŠ‚ç‚¹æºå¸¦ä¿¡æ¯
   if nodes_with_info:
       # è®¡ç®—è·¯å¾„ä¸Šçš„æ€»ä¿¡æ¯é‡ï¼ˆåŒ…æ‹¬æ–°è·¯å¾„ä¿¡æ¯ï¼‰
       if enable_accumulative_data_size:
           new_path_info = base_data_size Ã— len(path)  # æ–°è·¯å¾„ä¿¡æ¯
       else:
           new_path_info = base_data_size
       
       total_info_volume = new_path_info
       
       for node, node_info in nodes_with_info:
           total_info_volume += node_info.get('info_volume', 0)  # æ­è½½çš„ä¿¡æ¯
       
       # åœ¨è·¯å¾„ç»ˆç‚¹ä¸ŠæŠ¥æ€»ä¿¡æ¯é‡
       receiver = path[-1]
       report_info_to_center(receiver, total_info_volume)
       
       # æ ‡è®°ä¿¡æ¯å·²ä¸ŠæŠ¥ï¼ˆåœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æ›´æ–°ï¼Œé€šè¿‡self.vcè®¿é—®ï¼‰
       for node, node_info in nodes_with_info:
           self.vc.latest_info[node.node_id]['info_is_reported'] = True
           self.vc.latest_info[node.node_id]['info_volume'] = 0  # æ¸…é›¶ä¿¡æ¯é‡
           self.vc.latest_info[node.node_id]['info_waiting_since'] = -1
       
       # æ›´æ–°æ–°è·¯å¾„ç»ˆç‚¹çš„ä¿¡æ¯é‡ï¼ˆå»¶è¿Ÿä¸ŠæŠ¥æ¨¡å¼ï¼‰
       if enable_delayed_reporting:
           # ç¡®ä¿ç»ˆç‚¹èŠ‚ç‚¹åœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­
           if receiver.node_id not in self.vc.latest_info:
               self.vc.update_node_info(
                   node_id=receiver.node_id,
                   energy=receiver.current_energy,
                   record_time=current_time,
                   arrival_time=current_time,
                   position=tuple(receiver.position),
                   is_solar=receiver.has_solar
               )
           
           # ç¡®ä¿ä¿¡æ¯é‡å­—æ®µå­˜åœ¨
           if 'info_volume' not in self.vc.latest_info[receiver.node_id]:
               self.vc.latest_info[receiver.node_id]['info_volume'] = 0
               self.vc.latest_info[receiver.node_id]['info_waiting_since'] = -1
               self.vc.latest_info[receiver.node_id]['info_is_reported'] = True
           
           # æ–°è·¯å¾„ç»ˆç‚¹èŠ‚ç‚¹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ˆåœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æ›´æ–°ï¼‰
           self.vc.latest_info[receiver.node_id]['info_volume'] = new_path_info
           self.vc.latest_info[receiver.node_id]['info_waiting_since'] = current_time
           self.vc.latest_info[receiver.node_id]['info_is_reported'] = False
           if 'info_source_nodes' not in self.vc.latest_info[receiver.node_id]:
               self.vc.latest_info[receiver.node_id]['info_source_nodes'] = []
           self.vc.latest_info[receiver.node_id]['info_source_nodes'].extend([n.node_id for n in path])
       
       return True  # æˆåŠŸ"æ­ä¾¿è½¦"
   else:
       # æ²¡æœ‰èŠ‚ç‚¹æºå¸¦ä¿¡æ¯ï¼Œæ­£å¸¸å¤„ç†æ–°è·¯å¾„
       # å¦‚æœå¯ç”¨å»¶è¿Ÿä¸ŠæŠ¥ï¼Œç»ˆç‚¹èŠ‚ç‚¹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ˆåœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æ›´æ–°ï¼‰
       if enable_delayed_reporting:
           receiver = path[-1]
           if enable_accumulative_data_size:
               new_path_info = base_data_size Ã— len(path)
           else:
               new_path_info = base_data_size
           
           # ç¡®ä¿ç»ˆç‚¹èŠ‚ç‚¹åœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­ï¼ˆé€šè¿‡self.vcè®¿é—®ï¼‰
           if receiver.node_id not in self.vc.latest_info:
               self.vc.update_node_info(
                   node_id=receiver.node_id,
                   energy=receiver.current_energy,
                   record_time=current_time,
                   arrival_time=current_time,
                   position=tuple(receiver.position),
                   is_solar=receiver.has_solar
               )
           
           # ç¡®ä¿ä¿¡æ¯é‡å­—æ®µå­˜åœ¨
           if 'info_volume' not in self.vc.latest_info[receiver.node_id]:
               self.vc.latest_info[receiver.node_id]['info_volume'] = 0
               self.vc.latest_info[receiver.node_id]['info_waiting_since'] = -1
               self.vc.latest_info[receiver.node_id]['info_is_reported'] = True
           
           # åœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æ›´æ–°ä¿¡æ¯é‡çŠ¶æ€
           self.vc.latest_info[receiver.node_id]['info_volume'] = new_path_info
           self.vc.latest_info[receiver.node_id]['info_waiting_since'] = current_time
           self.vc.latest_info[receiver.node_id]['info_is_reported'] = False
           if 'info_source_nodes' not in self.vc.latest_info[receiver.node_id]:
               self.vc.latest_info[receiver.node_id]['info_source_nodes'] = []
           self.vc.latest_info[receiver.node_id]['info_source_nodes'].extend([n.node_id for n in path])
       else:
           # ç«‹å³ä¸ŠæŠ¥æ–°è·¯å¾„ä¿¡æ¯
           if enable_accumulative_data_size:
               new_path_info = base_data_size Ã— len(path)
           else:
               new_path_info = base_data_size
           report_info_to_center(path[-1], new_path_info)
       
       return False  # æ²¡æœ‰"æ­ä¾¿è½¦"
```

### **4. è¶…æ—¶å¼ºåˆ¶ä¸ŠæŠ¥æµç¨‹**

**å®ç°ä½ç½®**ï¼š`src/acdr/physical_center.py` - `NodeInfoManager`ç±»ï¼ˆæ–°å¢æ–¹æ³•ï¼‰

**è°ƒç”¨æ—¶æœº**ï¼šæ¯ä¸ªæ—¶é—´æ­¥ï¼ˆæ¯åˆ†é’Ÿï¼‰ç”±`EnergySimulation`è°ƒç”¨ï¼Œåœ¨èƒ½é‡ä¼ è¾“å†³ç­–ä¹‹å

```
è¾“å…¥ï¼šå½“å‰æ—¶é—´ current_timeï¼Œæœ€å¤§ç­‰å¾…æ—¶é—´ max_wait_time
è¾“å‡ºï¼šå¼ºåˆ¶ä¸ŠæŠ¥çš„èŠ‚ç‚¹æ•°é‡

ç®—æ³•ï¼š
1. æ£€æŸ¥æ‰€æœ‰ç­‰å¾…ä¸­çš„èŠ‚ç‚¹ï¼ˆä»èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æŸ¥è¯¢ï¼Œç›´æ¥é€šè¿‡self.latest_infoè®¿é—®ï¼‰
   timeout_nodes = []
   for node_id, node_info in self.latest_info.items():
       # ç¡®ä¿ä¿¡æ¯é‡å­—æ®µå­˜åœ¨ï¼ˆå…¼å®¹æ—§æ•°æ®ï¼‰
       info_volume = node_info.get('info_volume', 0)
       is_reported = node_info.get('info_is_reported', True)
       waiting_since = node_info.get('info_waiting_since', -1)
       
       # æ£€æŸ¥æ˜¯å¦æœ‰æœªä¸ŠæŠ¥çš„ä¿¡æ¯é‡
       if not is_reported and info_volume > 0 and waiting_since >= 0:
           # è®¡ç®—ç­‰å¾…æ—¶é—´
           wait_time = current_time - waiting_since
           
           # æ£€æŸ¥æ˜¯å¦è¶…æ—¶
           if wait_time >= max_wait_time:
               timeout_nodes.append((node_id, node_info))

2. å¯¹è¶…æ—¶èŠ‚ç‚¹å¼ºåˆ¶ä¸ŠæŠ¥
   for node_id, node_info in timeout_nodes:
       # è·å–ä¿¡æ¯é‡
       info_volume = node_info.get('info_volume', 0)
       
       # å¼ºåˆ¶å•ç‹¬ä¸ŠæŠ¥ï¼ˆæ¶ˆè€—ä¸“é—¨çš„ä¿¡æ¯ä¼ é€’èƒ½é‡ï¼‰
       # æ³¨æ„ï¼šéœ€è¦é€šè¿‡ç½‘ç»œå¯¹è±¡æŸ¥æ‰¾èŠ‚ç‚¹ï¼Œç„¶åè°ƒç”¨PathBasedInfoCollectorä¸ŠæŠ¥
       # æˆ–è€…åœ¨NodeInfoManagerä¸­ç›´æ¥å¤„ç†ä¸ŠæŠ¥é€»è¾‘
       report_info_to_center(node_id, info_volume)  # éœ€è¦ä¼ å…¥ç½‘ç»œå¯¹è±¡æŸ¥æ‰¾èŠ‚ç‚¹
       
       # åœ¨èŠ‚ç‚¹ä¿¡æ¯è¡¨ä¸­æ¸…é›¶ä¿¡æ¯é‡çŠ¶æ€
       self.latest_info[node_id]['info_is_reported'] = True
       self.latest_info[node_id]['info_volume'] = 0
       self.latest_info[node_id]['info_waiting_since'] = -1
       
       # è®°å½•å¼ºåˆ¶ä¸ŠæŠ¥ç»Ÿè®¡
       if not hasattr(self, 'forced_reports_count'):
           self.forced_reports_count = 0
       self.forced_reports_count += 1

3. è¿”å›å¼ºåˆ¶ä¸ŠæŠ¥çš„èŠ‚ç‚¹æ•°é‡
   return len(timeout_nodes)
```

---

## å®ç°ç»†èŠ‚

### **1. ä¿¡æ¯é‡ç´¯ç§¯è§„åˆ™**

#### **ç´¯ç§¯æ–¹å¼**

åœ¨ç´¯ç§¯æ¨¡å¼ä¸‹ï¼Œ**åªæœ‰ç»ˆç‚¹èŠ‚ç‚¹**ç´¯ç§¯æ•´æ¡è·¯å¾„çš„ä¿¡æ¯é‡ï¼š

```
è·¯å¾„ aâ†’bâ†’cï¼ˆ3ä¸ªèŠ‚ç‚¹ï¼Œbase_data_size = 100000 bitsï¼‰ï¼š

èŠ‚ç‚¹aï¼ˆèµ·ç‚¹ï¼‰ï¼š
  info_volume = 0ï¼ˆä¸ç´¯ç§¯ï¼Œåªè´Ÿè´£ä¼ è¾“ï¼‰
  æ¥æºèŠ‚ç‚¹ï¼š[]

èŠ‚ç‚¹bï¼ˆä¸­ç»§ï¼‰ï¼š
  info_volume = 0ï¼ˆä¸ç´¯ç§¯ï¼Œåªè´Ÿè´£è½¬å‘ï¼‰
  æ¥æºèŠ‚ç‚¹ï¼š[]

èŠ‚ç‚¹cï¼ˆç»ˆç‚¹ï¼‰ï¼š
  info_volume = base_data_size Ã— 3 = 300000 bitsï¼ˆæ•´æ¡è·¯å¾„çš„ä¿¡æ¯ï¼‰
  æ¥æºèŠ‚ç‚¹ï¼š[a, b, c]
```

#### **å¤šè·¯å¾„ç´¯ç§¯å¤„ç†**

å¦‚æœèŠ‚ç‚¹ä½œä¸ºç»ˆç‚¹å‚ä¸å¤šæ¡è·¯å¾„ï¼Œä¿¡æ¯é‡éœ€è¦åˆå¹¶ï¼š

```
åœºæ™¯ï¼šèŠ‚ç‚¹cå…ˆåä½œä¸ºä¸¤æ¡è·¯å¾„çš„ç»ˆç‚¹
è·¯å¾„1: aâ†’bâ†’c å®Œæˆï¼ˆèŠ‚ç‚¹cæ˜¯ç»ˆç‚¹ï¼‰
  èŠ‚ç‚¹cä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆæ¥æºï¼š[a, b, c]ï¼‰
  èŠ‚ç‚¹aã€bä¿¡æ¯é‡ = 0ï¼ˆä¸­é—´èŠ‚ç‚¹ä¸ç´¯ç§¯ï¼‰

è·¯å¾„2: dâ†’eâ†’c å®Œæˆï¼ˆèŠ‚ç‚¹cåˆæ˜¯ç»ˆç‚¹ï¼‰
  èŠ‚ç‚¹cåŸä¿¡æ¯é‡ = base_data_size Ã— 3
  æ–°è·¯å¾„ä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆdâ†’eâ†’cè¿™ä¸€æ®µï¼‰
  åˆå¹¶åä¿¡æ¯é‡ = base_data_size Ã— 6ï¼ˆæ³¨æ„ï¼šä¸æ˜¯ç®€å•ç›¸åŠ ï¼Œéœ€è¦è€ƒè™‘ä¿¡æ¯å»é‡ï¼‰
  èŠ‚ç‚¹dã€eä¿¡æ¯é‡ = 0ï¼ˆä¸­é—´èŠ‚ç‚¹ä¸ç´¯ç§¯ï¼‰

æ³¨æ„ï¼šå¦‚æœèŠ‚ç‚¹cåœ¨è·¯å¾„2ä¸­æ˜¯ä¸­é—´èŠ‚ç‚¹ï¼ˆå¦‚ dâ†’câ†’eï¼‰ï¼Œåˆ™ï¼š
  è·¯å¾„2: dâ†’câ†’e å®Œæˆ
    èŠ‚ç‚¹cåŸä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆä»è·¯å¾„1ç´¯ç§¯çš„ï¼‰
    èŠ‚ç‚¹cåœ¨è·¯å¾„2ä¸­æ˜¯ä¸­é—´èŠ‚ç‚¹ï¼Œä¸æ–°å¢ç´¯ç§¯
    èŠ‚ç‚¹cæœ€ç»ˆä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆä¿æŒä¸å˜ï¼‰
    èŠ‚ç‚¹dä¿¡æ¯é‡ = 0ï¼ŒèŠ‚ç‚¹eä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆè·¯å¾„2çš„ç»ˆç‚¹ï¼‰
```

**å»é‡ç­–ç•¥**ï¼ˆä¼˜åŒ–ç‚¹ï¼‰ï¼š
- å¦‚æœèŠ‚ç‚¹åœ¨ä¸åŒè·¯å¾„ä¸­ä½œä¸ºç»ˆç‚¹ï¼Œéœ€è¦åˆå¹¶ä¿¡æ¯é‡
- å¯ä»¥ç»´æŠ¤ä¿¡æ¯æ¥æºèŠ‚ç‚¹é›†åˆï¼Œé¿å…é‡å¤ç´¯ç§¯
- ç®€å•ç­–ç•¥ï¼šå¦‚æœèŠ‚ç‚¹å·²å‚ä¸è¿‡è·¯å¾„ï¼Œåªç´¯ç§¯æ–°å¢çš„ä¿¡æ¯é‡ï¼ˆæ¥æºèŠ‚ç‚¹ä¸é‡å¤ï¼‰

### **2. ä¿¡æ¯å¥–åŠ±æœºåˆ¶**

#### **å¥–åŠ±å…¬å¼**

åœ¨è·¯ç”±é€‰æ‹©æ—¶ï¼ŒèŠ‚ç‚¹çš„ç»¼åˆè¯„åˆ†ï¼š

```python
# åŸºç¡€è¯„åˆ†
base_score = efficiency Ã— (1 / cost)

# ä¿¡æ¯å¥–åŠ±
if enable_info_aware_routing:
    info_ratio = accumulated_info / base_data_size
    info_bonus = 1.0 + info_reward_factor Ã— info_ratio
    final_score = base_score Ã— info_bonus
else:
    final_score = base_score
```

#### **å‚æ•°è°ƒä¼˜**

- **info_reward_factor = 0.1**ï¼šè½»å¾®å¥–åŠ±ï¼Œä¿¡æ¯é‡å½±å“è¾ƒå°
- **info_reward_factor = 0.2**ï¼šé€‚ä¸­å¥–åŠ±ï¼ˆæ¨èï¼‰ï¼Œå¹³è¡¡ä¿¡æ¯é‡ä¸è·¯ç”±æ•ˆç‡
- **info_reward_factor = 0.3**ï¼šå¼ºçƒˆå¥–åŠ±ï¼Œä¿¡æ¯é‡å½±å“è¾ƒå¤§ï¼Œå¯èƒ½ç‰ºç‰²è·¯ç”±æ•ˆç‡

### **3. ç­‰å¾…æ—¶é—´ç®¡ç†**

#### **ç­‰å¾…æ—¶é—´è®¡ç®—**

```
ç­‰å¾…æ—¶é—´ = å½“å‰æ—¶é—´ - ä¿¡æ¯å¼€å§‹ç­‰å¾…çš„æ—¶é—´

if ç­‰å¾…æ—¶é—´ >= max_wait_time:
    è§¦å‘å¼ºåˆ¶ä¸ŠæŠ¥
```

#### **è¶…æ—¶ç­–ç•¥**

- **ç«‹å³ä¸ŠæŠ¥**ï¼šç­‰å¾…æ—¶é—´ = 0ï¼Œä¼ ç»Ÿæ¨¡å¼
- **çŸ­æœŸç­‰å¾…**ï¼šmax_wait_time = 5åˆ†é’Ÿï¼Œé€‚åˆé«˜é¢‘ç‡è·¯å¾„è§„åˆ’
- **ä¸­æœŸç­‰å¾…**ï¼šmax_wait_time = 10åˆ†é’Ÿï¼ˆæ¨èï¼‰ï¼Œå¹³è¡¡ç­‰å¾…ä¸æ–°é²œåº¦
- **é•¿æœŸç­‰å¾…**ï¼šmax_wait_time = 20åˆ†é’Ÿï¼Œé€‚åˆä½é¢‘ç‡è·¯å¾„è§„åˆ’

### **4. ä¿¡æ¯é‡é˜ˆå€¼**

#### **æœ€å°ä¿¡æ¯é‡é˜ˆå€¼**

åªæœ‰ä¿¡æ¯é‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ‰è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼š

```python
if accumulated_info >= base_data_size Ã— min_info_volume_threshold:
    # è¿›å…¥ç­‰å¾…çŠ¶æ€
else:
    # ç«‹å³ä¸ŠæŠ¥ï¼ˆä¿¡æ¯é‡å¤ªå°ï¼Œä¸å€¼å¾—ç­‰å¾…ï¼‰
```

**é˜ˆå€¼è®¾ç½®**ï¼š
- **min_info_volume_threshold = 1**ï¼šæ‰€æœ‰èŠ‚ç‚¹éƒ½ç­‰å¾…ï¼ˆé»˜è®¤ï¼‰
- **min_info_volume_threshold = 2**ï¼šåªæœ‰ä¿¡æ¯é‡â‰¥2ä¸ªèŠ‚ç‚¹çš„æ‰ç­‰å¾…
- **min_info_volume_threshold = 3**ï¼šåªæœ‰ä¿¡æ¯é‡â‰¥3ä¸ªèŠ‚ç‚¹çš„æ‰ç­‰å¾…

---

## é…ç½®å‚æ•°

### **1. EETORConfigæ‰©å±•**

```python
@dataclass
class EETORConfig:
    # ... ç°æœ‰å‚æ•° ...
    
    # ä¿¡æ¯æ„ŸçŸ¥è·¯ç”±å‚æ•°
    enable_info_aware_routing: bool = False  # æ˜¯å¦å¯ç”¨ä¿¡æ¯æ„ŸçŸ¥è·¯ç”±
    info_reward_factor: float = 0.2          # ä¿¡æ¯å¥–åŠ±ç³»æ•°ï¼ˆ0~1ï¼‰
    max_info_wait_time: int = 10             # æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    min_info_volume_threshold: int = 1        # æœ€å°ä¿¡æ¯é‡é˜ˆå€¼ï¼ˆèŠ‚ç‚¹æ•°ï¼‰
```

### **2. PathCollectorConfigæ‰©å±•**

```python
@dataclass
class PathCollectorConfig:
    # ... ç°æœ‰å‚æ•° ...
    
    # æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’å‚æ•°
    enable_opportunistic_info_forwarding: bool = True  # æ˜¯å¦å¯ç”¨æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’
    enable_delayed_reporting: bool = True               # æ˜¯å¦å¯ç”¨å»¶è¿Ÿä¸ŠæŠ¥
    max_wait_time: int = 10                              # æœ€å¤§ç­‰å¾…æ—¶é—´ï¼ˆåˆ†é’Ÿï¼‰
    min_info_volume_threshold: int = 1                   # æœ€å°ä¿¡æ¯é‡é˜ˆå€¼ï¼ˆèŠ‚ç‚¹æ•°ï¼‰
```

### **3. é…ç½®æ–‡ä»¶ç¤ºä¾‹**

```json
{
  "eetor": {
    "enable_info_aware_routing": true,
    "info_reward_factor": 0.2,
    "max_info_wait_time": 10,
    "min_info_volume_threshold": 1
  },
  "path_collector": {
    "enable_opportunistic_info_forwarding": true,
    "enable_delayed_reporting": true,
    "max_wait_time": 10,
    "min_info_volume_threshold": 1
  }
}
```

---

## ä½¿ç”¨åœºæ™¯

### **åœºæ™¯1ï¼šæˆåŠŸçš„"æ­ä¾¿è½¦"**

```
æ—¶é—´t1:
- è·¯å¾„ aâ†’bâ†’c å®Œæˆèƒ½é‡ä¼ è¾“
- èŠ‚ç‚¹cï¼ˆç»ˆç‚¹ï¼‰ä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆç­‰å¾…ä¸­ï¼‰
- èŠ‚ç‚¹aã€bï¼ˆä¸­é—´èŠ‚ç‚¹ï¼‰ä¿¡æ¯é‡ = 0ï¼ˆä¸ç´¯ç§¯ï¼‰

æ—¶é—´t2:
- è§„åˆ’æ–°è·¯å¾„ dâ†’câ†’e
- è·¯ç”±ç®—æ³•å‘ç°èŠ‚ç‚¹cä¿¡æ¯é‡å¤§ï¼Œä¼˜å…ˆé€‰æ‹©
- è·¯å¾„ dâ†’câ†’e ä¼ é€’èƒ½é‡
- èŠ‚ç‚¹cçš„ä¿¡æ¯"æ­ä¾¿è½¦"ä¸€èµ·ä¸ŠæŠ¥
- èŠ‚çœä¸€æ¬¡ä¸“é—¨çš„ä¿¡æ¯ä¼ é€’ï¼ˆèŠ‚èƒ½ï¼‰

ç»“æœï¼š
- ä¿¡æ¯ä¼ é€’èƒ½è€—ï¼š0ï¼ˆæ­è½½ï¼‰
- ä¿¡æ¯æ–°é²œåº¦ï¼šè‰¯å¥½ï¼ˆç­‰å¾…æ—¶é—´çŸ­ï¼‰
- èŠ‚ç‚¹cä¿¡æ¯é‡æ¸…é›¶
```

### **åœºæ™¯2ï¼šç­‰å¾…è¶…æ—¶**

```
æ—¶é—´t1:
- è·¯å¾„ aâ†’bâ†’c å®Œæˆèƒ½é‡ä¼ è¾“
- èŠ‚ç‚¹cï¼ˆç»ˆç‚¹ï¼‰ä¿¡æ¯é‡ = base_data_size Ã— 3ï¼ˆç­‰å¾…ä¸­ï¼‰
- èŠ‚ç‚¹aã€bï¼ˆä¸­é—´èŠ‚ç‚¹ï¼‰ä¿¡æ¯é‡ = 0

æ—¶é—´t2-t11:
- æ²¡æœ‰æ–°è·¯å¾„ç»è¿‡èŠ‚ç‚¹cï¼ˆä½œä¸ºç»ˆç‚¹æˆ–ä¸­é—´èŠ‚ç‚¹ï¼‰
- èŠ‚ç‚¹cç­‰å¾…æ—¶é—´ = 10åˆ†é’Ÿï¼ˆè¾¾åˆ°é˜ˆå€¼ï¼‰

æ—¶é—´t11:
- è§¦å‘è¶…æ—¶å¼ºåˆ¶ä¸ŠæŠ¥
- èŠ‚ç‚¹cå•ç‹¬ä¸ŠæŠ¥ä¿¡æ¯
- æ¶ˆè€—ä¸“é—¨çš„ä¿¡æ¯ä¼ é€’èƒ½é‡

ç»“æœï¼š
- ä¿¡æ¯ä¼ é€’èƒ½è€—ï¼šæ­£å¸¸ï¼ˆæœªèŠ‚çœï¼‰
- ä¿¡æ¯æ–°é²œåº¦ï¼šå¯æ¥å—ï¼ˆç­‰å¾…10åˆ†é’Ÿï¼‰
- èŠ‚ç‚¹cä¿¡æ¯é‡æ¸…é›¶
```

### **åœºæ™¯3ï¼šä¿¡æ¯é‡è¿‡å°**

```
æ—¶é—´t1:
- è·¯å¾„ aâ†’b å®Œæˆèƒ½é‡ä¼ è¾“ï¼ˆ2ä¸ªèŠ‚ç‚¹ï¼‰
- èŠ‚ç‚¹bï¼ˆç»ˆç‚¹ï¼‰ä¿¡æ¯é‡ = base_data_size Ã— 2
- èŠ‚ç‚¹aï¼ˆä¸­é—´èŠ‚ç‚¹ï¼‰ä¿¡æ¯é‡ = 0

åˆ¤æ–­ï¼š
- å¦‚æœ min_info_volume_threshold = 3
- èŠ‚ç‚¹bä¿¡æ¯é‡ < é˜ˆå€¼
- ç«‹å³ä¸ŠæŠ¥ï¼ˆä¸å€¼å¾—ç­‰å¾…ï¼‰

ç»“æœï¼š
- ä¿¡æ¯ä¼ é€’èƒ½è€—ï¼šæ­£å¸¸ï¼ˆç«‹å³ä¸ŠæŠ¥ï¼‰
- é¿å…æ— æ•ˆç­‰å¾…
- èŠ‚ç‚¹bä¿¡æ¯é‡æ¸…é›¶
```

---

## ä¼˜åŠ¿ä¸æƒè¡¡

### **ä¼˜åŠ¿**

1. **èŠ‚èƒ½**ï¼šå‡å°‘ä¸“é—¨çš„ä¿¡æ¯ä¼ é€’æ¬¡æ•°ï¼ŒèŠ‚çœé€šä¿¡èƒ½è€—
2. **æ™ºèƒ½**ï¼šè·¯ç”±ç®—æ³•æ™ºèƒ½é€‰æ‹©ä¿¡æ¯é‡å¤§çš„èŠ‚ç‚¹ï¼Œæé«˜"æ­ä¾¿è½¦"æˆåŠŸç‡
3. **çµæ´»**ï¼šå¯é…ç½®çš„ç­‰å¾…æ—¶é—´å’Œé˜ˆå€¼ï¼Œé€‚åº”ä¸åŒåœºæ™¯
4. **å…¼å®¹**ï¼šå¯ä»¥é€šè¿‡é…ç½®å¼€å…³åˆ‡æ¢ä¼ ç»Ÿæ¨¡å¼å’Œæœºä¼šä¸»ä¹‰æ¨¡å¼

### **æƒè¡¡**

1. **ä¿¡æ¯æ–°é²œåº¦ vs èƒ½è€—**ï¼šç­‰å¾…æ—¶é—´è¶Šé•¿ï¼Œèƒ½è€—è¶Šä½ï¼Œä½†ä¿¡æ¯å¯èƒ½è¿‡æ—¶
2. **è·¯ç”±æ•ˆç‡ vs ä¿¡æ¯é‡**ï¼šä¼˜å…ˆé€‰æ‹©ä¿¡æ¯é‡å¤§çš„èŠ‚ç‚¹å¯èƒ½ç‰ºç‰²è·¯ç”±æ•ˆç‡
3. **å¤æ‚åº¦ vs æ”¶ç›Š**ï¼šæœºåˆ¶å¤æ‚åº¦å¢åŠ ï¼Œéœ€è¦ä»”ç»†è°ƒä¼˜å‚æ•°
4. **å­˜å‚¨å¼€é”€**ï¼šéœ€è¦ç»´æŠ¤ä¿¡æ¯é‡çŠ¶æ€è¡¨ï¼Œå¢åŠ å­˜å‚¨å¼€é”€

### **é€‚ç”¨åœºæ™¯**

**é€‚åˆ**ï¼š
- èƒ½é‡ä¼ è¾“è·¯å¾„é¢‘ç‡è¾ƒé«˜
- ä¿¡æ¯ä¼ é€’èƒ½è€—æ˜¾è‘—
- å¯ä»¥å®¹å¿ä¸€å®šä¿¡æ¯å»¶è¿Ÿ

**ä¸é€‚åˆ**ï¼š
- éœ€è¦å®æ—¶ä¿¡æ¯ï¼ˆå»¶è¿Ÿæ•æ„Ÿï¼‰
- èƒ½é‡ä¼ è¾“è·¯å¾„é¢‘ç‡å¾ˆä½
- ä¿¡æ¯é‡æ™®éè¾ƒå°ï¼ˆç­‰å¾…æ”¶ç›Šä½ï¼‰

---

## æ€»ç»“

æœºä¼šä¸»ä¹‰ä¿¡æ¯ä¼ é€’æœºåˆ¶é€šè¿‡**å»¶è¿Ÿä¸ŠæŠ¥**å’Œ**æ­ä¾¿è½¦**ç­–ç•¥ï¼Œå°†ä¿¡æ¯ä¼ é€’ä¸èƒ½é‡ä¼ è¾“è·¯å¾„è€¦åˆï¼Œå®ç°èŠ‚èƒ½å’Œæ™ºèƒ½åŒ–çš„ä¿¡æ¯æ”¶é›†ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ï¼š

1. **è¿½è¸ª**ï¼šä¸­å¿ƒèŠ‚ç‚¹è¿½è¸ªæ¯ä¸ªèŠ‚ç‚¹çš„ç´¯ç§¯ä¿¡æ¯é‡
2. **ç­‰å¾…**ï¼šè·¯å¾„ç»“æŸåï¼ŒèŠ‚ç‚¹æºå¸¦ä¿¡æ¯ç­‰å¾…æ–°è·¯å¾„
3. **æ­è½¦**ï¼šæ–°è·¯å¾„ç»è¿‡æ—¶ï¼Œä¿¡æ¯"æ­ä¾¿è½¦"ä¸€èµ·ä¼ é€’
4. **è·¯ç”±**ï¼šè·¯ç”±ç®—æ³•ä¼˜å…ˆé€‰æ‹©ä¿¡æ¯é‡å¤§çš„èŠ‚ç‚¹
5. **ä¿æŠ¤**ï¼šè¶…æ—¶æœºåˆ¶ç¡®ä¿ä¿¡æ¯ä¸ä¼šæ— é™ç­‰å¾…

è¯¥æœºåˆ¶åœ¨èŠ‚èƒ½å’Œä¿¡æ¯æ–°é²œåº¦ä¹‹é—´å–å¾—å¹³è¡¡ï¼Œé€‚ç”¨äºæ— çº¿ä¼ æ„Ÿå™¨ç½‘ç»œä¸­çš„èƒ½é‡ä¼ è¾“åœºæ™¯ã€‚

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2024-10-29

