# 调度器信息价值功能分析

## 概述

目前只有 `DurationAwareLyapunovScheduler` 实现了信息价值功能。本文档分析其他调度器是否可以添加信息价值功能。

---

## 调度器列表

### 1. ✅ **DurationAwareLyapunovScheduler**（已实现）
- **状态**: 已添加信息价值功能
- **位置**: `_compute_duration_score` 方法
- **用途**: 在传输时长优化中，使用信息价值判断是否有未上报信息
- **影响**: 影响信息奖励的计算

---

### 2. ⚠️ **AdaptiveDurationLyapunovScheduler**（建议添加）
- **类型**: 自适应传输时长的Lyapunov调度器
- **当前状态**: 纯粹的能量优化，不考虑AoI和信息量
- **代码位置**: `src/scheduling/schedulers.py:660-810`
- **特点**: 
  - 尝试不同传输时长（1-5分钟）
  - 得分函数：`delivered × Q[r] - V × loss`
  - 注释明确说明"不考虑AoI和信息量"
- **建议**: 
  - ✅ **可以添加**：与 `DurationAwareLyapunovScheduler` 类似
  - **修改位置**: `_compute_duration_score` 方法
  - **修改方式**: 添加信息价值奖励项（类似 `DurationAwareLyapunovScheduler`）
  - **收益**: 在传输时长优化中考虑信息价值，提升信息传递效率

---

### 3. ❌ **LyapunovScheduler**（不建议添加）
- **类型**: 标准Lyapunov调度器
- **当前状态**: 只考虑能量传输，不涉及信息
- **代码位置**: `src/scheduling/schedulers.py:230-310`
- **特点**:
  - 得分函数：`eta * (Q_normalized + V) - V`
  - 纯粹的能量优化
  - 不涉及传输时长优化
- **建议**: 
  - ❌ **不建议添加**：该调度器专注于能量优化，不涉及信息传递
  - **原因**: 没有传输时长维度，无法利用信息价值的时间衰减特性

---

### 4. ❌ **AdaptiveLyapunovScheduler**（不建议添加）
- **类型**: 自适应参数调整的Lyapunov调度器
- **当前状态**: 继承自 `LyapunovScheduler`，只考虑能量
- **代码位置**: `src/scheduling/schedulers.py:313-508`
- **特点**:
  - 根据反馈动态调整V参数
  - 专注于能量均衡和传输效率
  - 不涉及信息传递
- **建议**: 
  - ❌ **不建议添加**：与 `LyapunovScheduler` 相同的原因

---

### 5. ❌ **BaselineHeuristic**（不建议添加）
- **类型**: 基础启发式调度器
- **当前状态**: 简单的贪心策略，只考虑能量和距离
- **代码位置**: `src/scheduling/schedulers.py:185-227`
- **特点**:
  - 选择能量最高的donor
  - 距离最近的优先
  - 最简单的调度策略
- **建议**: 
  - ❌ **不建议添加**：过于简单，不适合复杂的信息价值逻辑

---

### 6. ❌ **ClusterScheduler**（不建议添加）
- **类型**: 基于簇的调度器
- **当前状态**: 只考虑能量传输，不涉及信息
- **代码位置**: `src/scheduling/schedulers.py:509-601`
- **特点**:
  - 基于簇的能量传输
  - 簇头给簇内低能成员传能
  - 或者先给簇头充能
  - 不涉及信息传递
- **建议**: 
  - ❌ **不建议添加**：专注于能量优化，不涉及信息传递
  - **原因**: 没有传输时长维度，无法利用信息价值的时间衰减特性

---

### 7. ❌ **PredictionScheduler**（不建议添加）
- **类型**: 基于预测的调度器
- **当前状态**: 只考虑能量预测，不涉及信息
- **代码位置**: `src/scheduling/schedulers.py:602-659`
- **特点**:
  - 使用EWMA预测未来能量采集
  - 基于预测的能量盈余进行调度
  - 不涉及信息传递
- **建议**: 
  - ❌ **不建议添加**：专注于能量预测和优化，不涉及信息传递
  - **原因**: 没有传输时长维度，无法利用信息价值的时间衰减特性

---

### 8. ❌ **PowerControlScheduler**（不建议添加）
- **类型**: 功率控制调度器
- **当前状态**: 只考虑能量传输效率，不涉及信息
- **代码位置**: `src/scheduling/schedulers.py:1020-1108`
- **特点**:
  - 根据目标效率调整传输功率
  - 低效率时减小发送量
  - 不涉及信息传递
- **建议**: 
  - ❌ **不建议添加**：专注于功率控制，不涉及信息传递
  - **原因**: 没有传输时长维度，无法利用信息价值的时间衰减特性

---

### 9. ✅ **DDPGScheduler**（建议添加）
- **类型**: 基于DDPG深度强化学习的调度器
- **当前状态**: 状态空间包括节点能量、能量方差等
- **代码位置**: `src/scheduling/ddpg_scheduler.py:320+`
- **特点**:
  - 状态空间：节点能量、能量方差、低能量节点比例等
  - 动作空间：传输时长（连续，1-10分钟）
  - 奖励：能量均衡改善、传输效率、网络存活
- **建议**: 
  - ✅ **建议添加**：可以在状态空间中加入信息价值
  - **修改位置**: `_compute_state` 方法
  - **修改方式**: 
    1. 在状态向量中添加每个节点的信息价值
    2. 或者在奖励函数中加入信息价值奖励项
  - **收益**: 让DDPG学习考虑信息价值的传输策略

---

### 10. ✅ **DQNScheduler**（建议添加）
- **类型**: 基于DQN深度强化学习的调度器
- **当前状态**: 状态空间包括节点能量、能量方差等
- **代码位置**: `src/scheduling/dqn_scheduler.py:258+`
- **特点**:
  - 状态空间：节点能量、能量方差、低能量节点比例等
  - 动作空间：传输时长（离散，1-10分钟）
  - 奖励：能量均衡改善、传输效率、网络存活
- **建议**: 
  - ✅ **建议添加**：可以在状态空间中加入信息价值
  - **修改位置**: `_compute_state` 方法
  - **修改方式**: 
    1. 在状态向量中添加每个节点的信息价值
    2. 或者在奖励函数中加入信息价值奖励项
  - **收益**: 让DQN学习考虑信息价值的传输策略

---

## 总结

### 建议添加信息价值的调度器

| 调度器 | 优先级 | 原因 | 修改难度 |
|--------|--------|------|---------|
| **AdaptiveDurationLyapunovScheduler** | ⭐⭐⭐ | 与已实现的调度器类似，有传输时长维度 | 低 |
| **DDPGScheduler** | ⭐⭐ | 状态空间可以扩展，奖励函数可以优化 | 中 |
| **DQNScheduler** | ⭐⭐ | 状态空间可以扩展，奖励函数可以优化 | 中 |

### 不建议添加的调度器

| 调度器 | 原因 |
|--------|------|
| **LyapunovScheduler** | 专注于能量优化，无传输时长维度 |
| **AdaptiveLyapunovScheduler** | 继承自LyapunovScheduler，同样原因 |
| **BaselineHeuristic** | 过于简单，不适合复杂逻辑 |

### 已确认不建议添加的调度器

| 调度器 | 原因 |
|--------|------|
| **ClusterScheduler** | 专注于能量优化，不涉及信息传递 |
| **PredictionScheduler** | 专注于能量预测，不涉及信息传递 |
| **PowerControlScheduler** | 专注于功率控制，不涉及信息传递 |

---

## 实现建议

### 1. AdaptiveDurationLyapunovScheduler

**修改方式**:
```python
# 在 _compute_duration_score 方法中添加信息价值奖励
# 参考 DurationAwareLyapunovScheduler 的实现
```

**修改位置**: `src/scheduling/schedulers.py:694-720`

**修改内容**:
- 添加信息价值判断逻辑
- 在得分函数中加入信息价值奖励项

---

### 2. DDPGScheduler / DQNScheduler

**修改方式1: 扩展状态空间**
```python
# 在 _compute_state 方法中
# 添加每个节点的信息价值到状态向量
info_values = [calculate_info_value(node) for node in nodes]
state = np.concatenate([..., info_values])
```

**修改方式2: 优化奖励函数**
```python
# 在计算奖励时，加入信息价值奖励项
info_value_reward = sum(info_values) * info_reward_weight
reward += info_value_reward
```

**修改位置**: 
- `src/scheduling/ddpg_scheduler.py:_compute_state`
- `src/scheduling/dqn_scheduler.py:_compute_state`

---

## 注意事项

1. **向后兼容**: 添加信息价值功能时，需要确保向后兼容
2. **性能影响**: 信息价值计算开销很小（O(1)），但需要确保不影响调度器性能
3. **配置参数**: 需要确保 `path_collector` 和 `current_time` 可以正确传递
4. **测试验证**: 添加后需要测试验证功能正常

---

## 结论

**建议优先添加**:
1. ✅ **AdaptiveDurationLyapunovScheduler** - 最容易实现，与已实现的调度器类似
2. ✅ **DDPGScheduler / DQNScheduler** - 可以提升强化学习的效果

**不建议添加**:
- 专注于能量优化的调度器（LyapunovScheduler等）
- 过于简单的调度器（BaselineHeuristic）

